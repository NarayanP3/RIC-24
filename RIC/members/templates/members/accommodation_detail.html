{% extends 'base.html' %}
{% load static %}

{% block css %}
<style>
  /* Import Font Dancing Script */
    @import url(https://fonts.googleapis.com/css?family=Dancing+Script);

    * {
        margin: 0;
    }

    body {
        background-color: #e8f5ff;
        font-family: Arial;
    }

    /* NavbarTop */
    .navbar-top {
        background-color: #fff;
        color: #333;
        box-shadow: 0px 4px 8px 0px grey;
        height: 70px;
    }

    .title {
        font-family: 'Dancing Script', cursive;
        padding-top: 15px;
        position: absolute;
        left: 45%;
    }

    .navbar-top ul {
        float: right;
        list-style-type: none;
        margin: 0;
        overflow: hidden;
        padding: 18px 50px 0 40px;
    }

    .navbar-top ul li {
        float: left;
    }

    .navbar-top ul li a {
        color: #333;
        padding: 14px 16px;
        text-align: center;
        text-decoration: none;
    }

    .icon-count {
        background-color: #ff0000;
        color: #fff;
        float: right;
        font-size: 11px;
        left: -25px;
        padding: 2px;
        position: relative;
    }

    /* End */

    /* Sidenav */
    .sidenav {
        background-color: #fff;
        color: #333;
        border-bottom-right-radius: 25px;
        height: 86%;
        left: 0;
        overflow-x: hidden;
        padding-top: 20px;
        position: absolute;
        top: 70px;
        width: 250px;
    }

    .profile {
        margin-bottom: 20px;
        margin-top: -12px;
        text-align: center;
    }

    .profile img {
        border-radius: 50%;
        box-shadow: 0px 0px 5px 1px grey;
    }

    .name {
        font-size: 20px;
        font-weight: bold;
        padding-top: 20px;
    }

    .job {
        font-size: 16px;
        font-weight: bold;
        padding-top: 10px;
    }

    .url, hr {
        text-align: center;
    }

    .url hr {
        margin-left: 20%;
        width: 60%;
    }

    .url a {
        color: #818181;
        display: block;
        font-size: 20px;
        margin: 10px 0;
        padding: 6px 8px;
        text-decoration: none;
    }

    .url a:hover, .url .active {
        background-color: #e8f5ff;
        border-radius: 28px;
        color: #000;
        margin-left: 14%;
        width: 65%;
    }

    /* End */

    /* Main */
    .main {
        margin-top: 2%;
        margin-left: 23%;
        font-size: 28px;
        padding: 0 10px;
        width: 58%;
    }

    .main h2 {
        color: #333;
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        font-size: 24px;
        margin-bottom: 10px;
    }

    .main .card {
        background-color: #fff;
        border-radius: 18px;
        box-shadow: 1px 1px 8px 0 grey;
        height: auto;
        /* height: 2000px; */
        margin-bottom: 20px;
        padding: 20px 0 20px 50px;
    }

    .main .card table {
        border: none;
        font-size: 50%;
        height: auto;
        width: 80%;
    }

    .edit {
        position: absolute;
        color: #e7e7e8;
        right: 14%;
    }

    .social-media {
        text-align: center;
        width: 90%;
    }

    .social-media span {
        margin: 0 10px;
    }

    .fa-facebook:hover {
        color: #4267b3 !important;
    }

    .fa-twitter:hover {
        color: #1da1f2 !important;
    }

    .fa-instagram:hover {
        color: #ce2b94 !important;
    }

    .fa-invision:hover {
        color: #f83263 !important;
    }

    .fa-github:hover {
        color: #161414 !important;
    }

    .fa-whatsapp:hover {
        color: #25d366 !important;
    }

    .fa-snapchat:hover {
        color: #fffb01 !important;
    }

/* End */  
</style>
{% endblock css %}

{% block banner %}
<section>
  <div class="lgx-banner lgx-banner-music">
    <div class="lgx-banner-style">
      <div class="lgx-inner lgx-inner-fixed">
        <div class="container">
          <div class="row">
            <h1>Your Accommodation Info</h1>
          </div>
        </div>
      </div>
      <!--//.ROW-->
    </div>
    <!-- //.CONTAINER -->
  </div>
  <!-- //.INNER -->
  </div>
  </div>
</section>
{% endblock banner %}
{% block content %}
<div class="main">
  <h2>General Information</h2>
  <div class="card">
      <div class="card-body">
          <i class="fa fa-pen fa-xs edit"></i>
          <table>
              <tbody>
                  <tr>
                      <td>Name</td>
                      <td>:</td>
                      <td>{{object.owner}}</td>
                  </tr>
                  <tr>
                      <td>Institute</td>
                      <td>:</td>
                      <td>{{object.college}}</td>
                  </tr>
                  <tr>
                      <td>Address</td>
                      <td>:</td>
                      <td>{{object.address_line_1}}  <br> {{ object.address_line_2 }} </td>
                  </tr>
                  <tr>
                      <td>Pincode</td>
                      <td>:</td>
                      <td>{{object.pincode}}</td>
                  </tr>
                  <tr>
                      <td>Phone no.</td>
                      <td>:</td>
                      <td>{{object.number}}</td>
                  </tr>
                  <tr>
                      <td>RC Events Registered </td>
                      <td>:</td>
                      <td>{% for i in object.event_rc_list.all %}{{i}}{% endfor %}</td>
                  </tr>
                  <tr>
                      <td>IC Events Registered </td>
                      <td>:</td>
                      <td>{% for i in object.event_ic_list.all %}{{i}}{% endfor %}</td>
                  </tr>

                  {% comment %} <tr>
                      <td>ID Card</td>
                      <td>:</td>
                      <td><a href="{{object.id_card.url}}">ID Card</a></td>
                  </tr> {% endcomment %}
                  <tr>
                    <td> Getting Accommodation?</td>
                      <td>:</td>
                      <td>
                        {% if object.getting_accommodation %}
                            Congratulations, you'll be receiving Accommodation at IIT Guwahati
                        {% else %}
                            Accommodation Details to be verified
                        {% endif %}
                        </td>
                      {% comment %} <td>{{object.getting_accommodation}}</td> {% endcomment %}
                  </tr>

              </tbody>
          </table>
      </div>
  </div>
  <h2>Payment Details</h2>
  <div class="card">
      <div class="card-body">
          <i class="fa fa-pen fa-xs edit"></i>
          <table>
              <tbody>
                  <tr>
                      <td>Amount to be paid</td>
                      <td>:</td>
                      <td>{{rupee}}</td>
                  </tr>

                {% if object.selected %}
                    {% if not object.razorpay_payment_id %}
                    <tr>
                        <td>Payment Link</td>
                        <td>:</td>
                        <td><button id="rzp-button1">Pay</button></td>
                    </tr> 
                    {% else %}
                    <tr>
                        <td>Payment Id</td>
                        <td>:</td>
                        <td>{{object.razorpay_payment_id}}</td>
                    </tr>
                    {% endif %}
                {% endif %}
              </tbody>
          </table>
      </div>
  </div>



    <h2>Remarks </h2>
  <div class="card">
      <div class="card-body">
          <i class="fa fa-pen fa-xs edit"></i>
          <table>
              <tbody>
                    <tr>
                        <td>Remarks</td>
                        <td>:</td>
                        <td><a href="{% url 'members:id_card' object.id %}">{{object.remarks}}</a></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

{% if object.selected %}
<h2>Selected </h2>
<div class="card">
    <div class="card-body">
        <i class="fa fa-pen fa-xs edit"></i>
        <table>
            <tbody>
                <tr>
                    <td>
                        Oral or Poster</td>
                    <td>:</td>
                    {% if object.selected_oral %}
                        <td id="blink">Oral</td>
                    {% else %}
                        <td>Poster</td>
                    {% endif %}
                </tr>
                <tr>
                    <td>Other Events</td>
                    <td>:</td>
                    <td>{% for i in object.event1.all %}{{i}}{% endfor %}</td>
                </tr>
              </tbody>
          </table>
      </div>
  </div>
<h2>Instructions for event </h2>
<div class="card">
    <div class="card-body">
        <i class="fa fa-pen fa-xs edit"></i>
       <p>{{object.text|safe}}</p>
      </div>
  </div>

{% endif %}

</div>
{% if object.abstractFormat %}
<div>

  {% if  not object.razorpay_payment_id %}






  <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
  <script>
    let object_id = "{{ object.id }}";
    var options = {
      "key": "rzp_test_5yvtSG4kkzANL2", // Enter the Key ID generated from the Dashboard
      "amount": "{{object.total}}", // Amount is in currency subunits. Default currency is INR. Hence, 50000 refers to 50000 paise
      "currency": "INR",
      "name": "Acme Corp",
      "description": "Test Transaction",
      "image": "https://example.com/your_logo",
      "order_id": "{{order}}", //This is a sample Order ID. Pass the `id` obtained in the response of Step 2
      "handler": function (response) {
        alert("Please Copy This Transaction ID : " + response.razorpay_payment_id);
	      fetch(`/profile/detail/${object_id}/`,{
		      method:"POST",
		      body:JSON.stringify({
			      payment_id:response.razorpay_payment_id
		      }),
		      headers:{
		        "Content-Type":"application/json",
		      },
		      credentials:"include"
	      }).then(res=>res.json()).then(data=>{
	         alert(data.message)
	      }).catch(err=>{
		if(err.message){
		  alert(err.message);
			return;
		}
	        alert(err.response.data || err.message)
	      })
        // alert(response.razorpay_order_id);
        // alert(response.razorpay_signature)
      },
      "prefill": {
        "name": "Gaurav Kumar",
        "email": "gaurav.kumar@example.com",
        "contact": "9999999999"
      },
      "notes": {
        "address": "Razorpay Corporate Office"
      },
      "theme": {
        "color": "#3399cc"
      }
    };
    var rzp1 = new Razorpay(options);
    rzp1.on('payment.failed', function (response) {
      alert(response.error.code);
      alert(response.error.description);
      alert(response.error.source);
      alert(response.error.step);
      alert(response.error.reason);
      alert(response.error.metadata.order_id);
      alert(response.error.metadata.payment_id);
    });
    document.getElementById('rzp-button1').onclick = function (e) {
      rzp1.open();
      e.preventDefault();
    }
  </script>

{% endif %}

</div>
{% else %}
{% endif %}





<br><br>

<script type="text/javascript">
    var blink = document.getElementById('blink');
    setInterval(function() {
        blink.style.opacity = (blink.style.opacity == 0 ? 1 : 0);
    }, 100);
</script>
{% endblock content %}